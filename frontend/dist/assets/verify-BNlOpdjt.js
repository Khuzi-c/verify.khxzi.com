import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */const f=window.location.hostname==="localhost"?"http://localhost:3004":"";document.addEventListener("DOMContentLoaded",async()=>{const a=new URLSearchParams(window.location.search).get("session"),m=document.getElementById("user-info"),n=document.getElementById("verify-btn"),o=document.getElementById("resend-btn"),u=document.getElementById("verification-code"),d=document.getElementById("error-message"),i=document.getElementById("timer");if(!a){window.location.href="/";return}try{const e=JSON.parse(atob(a));m.innerHTML=`<p>Logged in as: <strong>${e.username}#${e.discriminator}</strong></p>`,await c(e.id)}catch(e){console.error("Invalid session:",e),window.location.href="/"}async function c(e){o.disabled=!0;try{const s=await(await fetch(`${f}/api/verify/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({discordId:e})})).json();s.success?y(60):(r(s.error||"Failed to send code."),o.disabled=!1)}catch{r("Network error sending code."),o.disabled=!1}}n.addEventListener("click",async()=>{const e=u.value.trim();if(e.length!==6){r("Please enter a valid 6-digit code.");return}const t=JSON.parse(atob(a));n.disabled=!0,n.textContent="Verifying...";try{const l=await(await fetch(`${f}/api/verify/check`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({discordId:t.id,code:e})})).json();l.success?window.location.href="/success.html":(r(l.error||"Invalid code."),n.disabled=!1,n.textContent="Verify Code")}catch{r("Network error verifying code."),n.disabled=!1,n.textContent="Verify Code"}}),o.addEventListener("click",()=>{const e=JSON.parse(atob(a));c(e.id)});function y(e){let t=e;o.disabled=!0,i.textContent=`(${t}s)`;const s=setInterval(()=>{t--,i.textContent=`(${t}s)`,t<=0&&(clearInterval(s),i.textContent="",o.disabled=!1)},1e3)}function r(e){d.textContent=e,d.style.display="block"}});
